unit PCInfo;

interface

function GetOwnerAndCompanyNamefunction: String;
// Информация о компьютере.
function GetHardwareInfo(Info: integer): string;

implementation

uses
   Registry, Windows, SysUtils;

function GetOwnerAndCompanyName: String;
var
  reg: TRegistry;
  vi: TOSVersionInfo;
  sWindows: string;  

begin
  reg     :=TRegistry.Create;
  sWindows:='\Windows\';
  try
    vi.dwOSVersionInfoSize := SizeOf(vi);
    getversionex(vi);
    reg.RootKey := HKEY_LOCAL_MACHINE;
    if (vi.dwPlatformId = VER_PLATFORM_WIN32_NT) then sWindows := '\Windows NT\';
    if reg.OpenKey('Software\Microsoft' + sWindows + 'CurrentVersion', False) then
    begin
      // Name
      Result:='RegisteredOwner='+reg.ReadString('RegisteredOwner')+', ';
      // Organization
      Result:=Result+'RegisteredOrganization='+reg.ReadString('RegisteredOrganization');
    end;
  finally
    reg.Free;
  end;
end;

// Информация о компьютере.
function GetHardwareInfo(Info: integer): string;
var
  Size : cardinal;
  PRes : PChar;
  BRes : boolean;
  lpSystemInfo : TSystemInfo;
begin
case Info of
// Имя компьютера
0: begin
     Size := MAX_COMPUTERNAME_LENGTH + 1;
     PRes := StrAlloc(Size);
     BRes := GetComputerName(PRes, Size);
     if BRes then Result:= StrPas(PRes);
   end;
// Имя пользователя
1: begin
     Size := MAX_COMPUTERNAME_LENGTH + 1;
     PRes := StrAlloc(Size);
     BRes := GetUserName(PRes, Size);
     if BRes then Result:= StrPas(PRes);
   end;
// Процессор
2: begin
     GetSystemInfo(lpSystemInfo);
     Result:=IntToStr(lpSystemInfo.dwProcessorType);
   end;
end;
end;


end.
